# ABMS 도메인 모델

## [시스템 필드]

시스템 필드는 모든 도메인 엔티티에 공통적으로 적용되는 감사/삭제 정보입니다.

### 속성

- `createdAt`: `LocalDateTime` 엔티티가 생성된 날짜 및 시간
- `updatedAt`: `LocalDateTime` 엔티티 정보가 마지막으로 업데이트된 날짜 및 시간
- `createdBy`: `String` 엔티티를 생성한 사용자의 ID
- `updatedBy`: `String` 마지막으로 업데이트한 사용자의 ID
- `deleted`: `Boolean` 논리 삭제 여부 플래그(기본값 false)
- `deletedAt`: `LocalDateTime` 엔티티가 논리 삭제된 날짜 및 시간
- `deletedBy`: `String` 엔티티를 논리 삭제한 사용자의 ID

## [직원 Aggregate]

## 직원 (Employee)

_Aggregate Root_

### 속성(필드)

- `id`: `UUID` 고유 식별자 (AbstractEntity)
- `departmentId`: `UUID` 소속 부서 ID (not null)
- `name`: `String` 이름 (길이 최대 10, not null)
- `email`: `Email` 임베디드 값 객체 (컬럼명 `email_address`, not null, unique)
- `joinDate`: `LocalDate` 입사일 (not null)
- `birthDate`: `LocalDate` 생년월일 (not null)
- `position`: `EmployeePosition` 직급 (Enum, STRING, not null)
- `type`: `EmployeeType` 고용 형태 (Enum, STRING, not null)
- `status`: `EmployeeStatus` 재직 상태 (Enum, STRING, not null)
- `grade`: `EmployeeGrade` 등급 (Enum, STRING, not null)
- `resignationDate`: `LocalDate` 퇴사일 (nullable)
- `memo`: `String` 메모 (TEXT, nullable)
- 시스템 필드: BaseEntity의 감사/삭제 필드 일괄 적용

### 행위(메서드)

- `static create()`: 직원을 생성
- `resign()`: 퇴사 처리
- `takeLeave()`: 휴직 처리
- `activate()`: 재직 상태로 활성화
- `updateInfo()`: 직원 정보를 업데이트 (이름, 이메일, 직급, 고용 형태, 등급, 메모)
- `promote()`: 직원의 직급을 승진

### 규칙/제약

- 직원의 이메일은 고유해야 하며, 중복된 이메일은 허용하지 않음
- 직원 생성시 직원의 상태는 `ACTIVE(재직)`로 초기화
- 직원이 퇴사 처리되면 `status`를 `RESIGNED(퇴사)`로 변경하고 `resignationDate`에 퇴사일을 설정
    - 이미 퇴사한 직원은 퇴사 처리할 수 없음
    - 직원의 퇴사일은 반드시 입사일 이후여야 함
- 직원은 `ON_LEAVE(휴직)` 상태로 변경할 수 있다
    - 직원의 휴직 상태는 `ACTIVE(재직)` 상태에서만 변경 가능
- 퇴사한 직원의 정보는 수정할 수 없다
- 직원 정보 수정 시 이메일 중복 검증을 수행하여 중복된 이메일이 등록되지 않도록 함
- 직원이 soft delete될 때 이메일 주소를 `"deleted.{timestamp}.{원래이메일}"` 형식으로 변경하여 중복 검증 충돌을 방지
- 직원은 하나의 부서에만 소속될 수 있으며, `departmentId`는 반드시 유효한 부서 ID여야 함
- 직원 승진시 현재 직급보다 같거나 높은 직급으로만 변경 가능

### 이메일 주소 (Email)

_Value Object_

- `address`: 이메일 주소 값
- 표준 이메일 형식을 정규식으로 검증

### EmployeePosition

_enum_

- 값: `ASSOCIATE(사원)`, `STAFF(선임)`, `LEADER(책임)`, `MANAGER(팀장)`, `SENIOR_MANAGER(수석)`, `DIRECTOR(이사)`,
  `TECHNICAL_DIRECTOR(기술이사)`, `MANAGING_DIRECTOR(상무)`, `VICE_PRESIDENT(부사장)`, `PRESIDENT(사장)`

### EmployeeType

_enum_

- 값: `FULL_TIME(정직원)`, `FREELANCE(프리랜서)`, `OUTSOURCING(외주)`, `PART_TIME(반프리)`

### EmployeeStatus

_enum_

- 값: `ACTIVE(재직)`, `ON_LEAVE(휴직)`, `RESIGNED(퇴사)`

### EmployeeGrade

_enum_

- 값: `JUNIOR(초급)`, `MID_LEVEL(중급)`, `SENIOR(고급)`, `EXPERT(특급)`

### DuplicateEmailException

_Exception_

- 이메일 중복 등록 시 발생하는 예외

## [부서 Aggregate]

## 부서 (Department)

_Aggregate Root_

### 속성(필드)

- `id`: `UUID` 고유 식별자 (AbstractEntity)
- `name`: `String` 부서명 (길이 최대 30, not null)
- `code`: `String` 부서코드 (길이 최대 32, not null, unique)
- `type`: `DepartmentType` 부서 유형 (Enum, STRING, not null)
- `leaderEmployeeId`: `UUID` 부서장 직원 ID (nullable)
- `parent`: `Department` 상위 부서 (nullable, lazy loading)
- `children`: `List<Department>` 하위 부서 목록 (1:N 관계, cascade persist/merge)
- 시스템 필드: BaseEntity의 감사/삭제 필드 일괄 적용

### 행위(메서드)

- `static createRoot()`: 최상위 부서(루트)를 생성
- `static create()`: 하위 부서를 생성 (상위 부서 연결)

### 규칙/제약

- 부서의 코드는 고유해야 하며, 중복된 코드는 허용하지 않음
- 부서는 계층구조를 가지며, 하나의 상위 부서에 여러 하위 부서가 소속될 수 있음
- 최상위 부서(루트)는 상위 부서가 없음 (`parent`가 null)
- 하위 부서 생성 시 반드시 유효한 상위 부서가 있어야 함
- 부서 간 부모-자식 관계는 양방향으로 관리됨
- 부서장(`leaderEmployeeId`)은 반드시 해당 부서에 소속된 직원이어야 함
- 부서의 부서장은 공석일 수 있음 (nullable)

### DepartmentType

_enum_

- 값: `COMPANY(회사)`, `DIVISION(본부)`, `DEPARTMENT(담당)`, `TEAM(팀)`, `LAB(연구소)`, `TF(TF)`
