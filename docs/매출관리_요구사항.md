# 📋 [요구사항 정의서] 매출 및 손익 관리 시스템

## 1. 시스템 개요 (System Overview)

### 1.1 목표
프로젝트의 **계약(매출)**과 인력의 **투입(비용)**을 연계하여, **프로젝트별 및 주관 부서별 월별 손익**을 정확하게 산출하고 시뮬레이션한다.

### 1.2 핵심 원칙
1.  **매출 (Revenue):** 세금계산서 발행 시점(**청구 기준**)에 인식한다.
2.  **비용 (Cost):** 인력의 월별 투입 공수(MM)에 급여 및 제경비율(**실행 원가**)을 곱하여 산출한다.
3.  **귀속 (Attribution):** 모든 손익은 인력의 소속 부서가 아닌, 프로젝트를 수행하는 **주관 부서**로 귀속된다.

---

## 2. 상세 업무 규칙 (Business Rules)

### ① 매출(Revenue) 인식 규칙: [Billing 기준]
* **정의:** 프로젝트 계약 시 수립된 **'대금 청구 계획(Billing Plan)'**을 해당 월의 매출로 확정한다.
* **입력 방식:**
    * 프로젝트 등록 시, 전체 계약금액을 차수별(착수금, 중도금, 잔금 등)로 나누어 입력한다.
    * 각 차수별로 **청구 예정월**과 **청구 금액**을 지정한다.
* **특이사항:**
    * 청구 계획이 없는 월은 **매출이 '0원'**으로 집계된다. (비용만 발생하여 월별 적자 발생 가능)
    * 모든 금액은 부가세(VAT)를 제외한 **공급가액**을 기준으로 한다.

### ② 비용(Cost) 산정 규칙: [실행 원가 기준]
* **정의:** 직원이 프로젝트에 투입된 만큼(MM) 비용을 계산한다.
* **계산 공식:**
  > **월 투입 비용** = (월 기본급 × 투입 MM) × (1 + 제경비율 + 판관비율)

* **직원 유형별 차등 적용:**
    * 직원의 고용 형태(정직원, 프리랜서, 파견직 등)에 따라 서로 다른 요율을 적용한다.
    * **제경비율:** 4대보험, 퇴직충당금 등 직접성 경비.
    * **판관비율:** 본사 운영비, 임대료 등 배부성 경비.
    * *예시: 정직원(제경비 10%, 판관비 20% → 1.3배), 프리랜서(제경비 0%, 판관비 0% → 1.0배)*

### ③ 인력 투입(Input) 관리 규칙
* **단위:** **Man-Month (MM)**를 사용한다. (1.0 = 1개월 Full 투입)
* **기간:** 프로젝트 기간 내에서 **월(Month)** 단위로 계획을 수립한다. (일일 타임시트 X)
* **MM 산출 로직 (일할 계산):**
    * **현재 기준 (Phase 1):** `투입 일수 / 해당 월의 총 일수(28~31일)` (Calendar Day 기준)
    * **향후 계획 (Phase 2):** `투입 영업일 / 해당 월의 총 영업일` (Business Day 기준)로 고도화 예정.
* **제약:**
    * 동일 직원이 같은 월에 여러 프로젝트에 분산 투입될 수 있다.
    * 퇴사자의 경우, 퇴사일 이후에는 투입 계획을 수립할 수 없다.

### ④ 손익(Profit) 집계 및 귀속 규칙
* **프로젝트 손익:**
    * `월 이익` = (그 달의 세금계산서 발행액) - (그 달의 총 투입 인력 비용)
    * `누적 이익` = 프로젝트 시작부터 현재까지의 (총 매출 - 총 비용)
* **부서 귀속:**
    * 모든 매출과 비용은 프로젝트의 **[주관 부서]**로 귀속된다.
    * 타 부서 직원이 지원 투입되더라도, 해당 인건비는 프로젝트 주관 부서의 비용(원가)으로 처리된다.

---

## 3. 데이터 시뮬레이션 (Data Simulation)

**매출(Billing)은 청구 계획에 따라 고정적**으로 발생하지만, **비용(Cost)은 투입 기간에 따라 유동적**으로 변하는 구조를 보여줍니다.

### 3.1 시나리오 설정
* **비용 기준:** 제시된 '월 원가'는 급여에 **간접비(제경비 + 판관비)를 모두 포함한 금액**입니다.
* **프로젝트:** 글로벌 플랫폼 구축 (기간: **3월 10일 ~ 5월 20일**)
* **계약금액:** 3억 원 (3회 분할 청구)
* **투입 인력:**
    1. **홍길동 (PM/정직원):** 3/10 ~ 5/20 (Full) / 월원가 650만
    2. **이자벨 (PL/정직원):** 3/10 ~ 5/20 (Full) / 월원가 650만
    3. **응우옌 (DEV/프리):** **4/01 ~ 5/20** (Part) / 월원가 600만

### 3.2 월별 데이터 산출 (일할 계산 적용)

| 구분 | 3월 (착수) | 4월 (중도) | 5월 (종료) | **합 계** |
| :--- | :---: | :---: | :---: | :---: |
| **기간 이슈** | **22일 투입** (10일~) | **Full 투입** (1일~30일) | **20일 투입** (~20일) | - |
| **① 매출 (Revenue)** | **1.0 억** <br>*(착수금 100%)* | **1.0 억** <br>*(중도금 100%)* | **1.0 억** <br>*(잔금 100%)* | **3.0 억** |
| **홍길동 비용** | 455 만 <br>*(0.7MM)* | 650 만 <br>*(1.0MM)* | 422 만 <br>*(0.65MM)* | 1,527 만 |
| **이자벨 비용** | 455 만 <br>*(0.7MM)* | 650 만 <br>*(1.0MM)* | 422 만 <br>*(0.65MM)* | 1,527 만 |
| **응우옌 비용** | - <br>*(미투입)* | 600 만 <br>*(1.0MM)* | 390 만 <br>*(0.65MM)* | 990 만 |
| **② 총 비용 (Cost)** | **910 만** | **1,900 만** | **1,234 만** | **4,044 만** |
| **③ 월 이익 (①-②)** | <span style="color:blue">**+9,090 만**</span> | <span style="color:blue">**+8,100 만**</span> | <span style="color:blue">**+8,766 만**</span> | **+2억 5,956 만** |

> **Analysis (손익 변동 원인 분석):**
> * **3월 (고이익):** 프로젝트가 10일에 시작되어 인건비는 **약 2/3(0.7MM)**만 발생했으나, 매출은 계약된 **착수금(1억) 전액**이 인식되어 이익률이 가장 높음.
> * **4월 (저이익):** 프리랜서(응우옌)가 추가 투입되고 모든 인력이 꽉 채워서 근무(Full MM)하여 **비용이 가장 많이 발생**함.
> * **5월 (반등):** 20일에 프로젝트가 종료되어 인건비가 감소(0.65MM)함에 따라 이익이 다시 증가함.

---

## 4. 데이터 모델링 핵심 엔티티 (Key Entities)

1.  **프로젝트 (Project):** 수행 단위, 주관 부서(`leadDepartmentId`) 포함.
2.  **매출 계획 (ProjectRevenuePlan):** 청구 월, 금액, 발행 여부.
3.  **프로젝트 투입 (ProjectAssignment):** 직원, 월, 투입률(MM).
4.  **직원 원가 정책 (EmployeeCostPolicy):** 연도별/직원유형별 제경비 및 판관비율.
5.  **월별 집계 (ProjectMonthlySum):** 배치 작업으로 생성된 월별 확정 실적. -> 설연휴에 제대로 설계해볼것임

---

## 5. 주요 의사결정 사항 (Decision Log)

| 항목 | 고려 사항 | **최종 결정** | 비고 |
| :--- | :--- | :--- | :--- |
| **매출 기준** | 월할(기간) 배분 vs 청구 기준 | **청구(Billing) 기준** | 현금 흐름 및 세금계산서 발행 시점 일치 |
| **비용 산정** | 순수 급여 vs 실행 원가 | **실행 원가** | 간접비(Overhead)를 포함하여 실제 수익성 분석 |
| **투입 관리** | 일별 타임시트 vs 월별 계획 | **월별 투입 계획(MM)** | 관리 효율성 증대 (일 단위 입력 부담 제거) |
| **MM 산출 로직** | 일할(Calendar) vs 영업일(Biz) | **일할 계산 (총 일수)** | 초기 복잡도 최소화. 향후 영업일 기준으로 변경 예정 |
| **손익 귀속** | 인력 소속 부서 vs 주관 부서 | **주관 부서 귀속** | 프로젝트 책임 부서 중심의 실적 관리 |


