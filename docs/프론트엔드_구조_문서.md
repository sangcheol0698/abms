# ABMS 프론트엔드 구조 문서

## 개요

ABMS 프론트엔드는 **Vue 3 + TypeScript + Vite**로 구성된 단일 페이지 애플리케이션(SPA)입니다.

**주요 기술 스택**:
- **프레임워크**: Vue 3.5+ (Composition API)
- **빌드 도구**: Vite 7
- **언어**: TypeScript 5.8 (strict mode)
- **상태 관리**: Pinia 3
- **라우팅**: Vue Router 4
- **스타일링**: Tailwind CSS 4
- **UI 컴포넌트**: shadcn-vue (Reka UI 기반)
- **테이블**: TanStack Table 8
- **폼 검증**: vee-validate + zod
- **HTTP 클라이언트**: Axios
- **DI 컨테이너**: tsyringe

---

## 프로젝트 구조

```
frontend/
├── src/
│   ├── main.ts              # 앱 진입점 (DI, 테마, Vue 앱 초기화)
│   ├── App.vue              # 루트 컴포넌트
│   ├── index.css            # 전역 CSS (Tailwind, 테마 변수, 폰트)
│   │
│   ├── core/                # 인프라 레이어
│   │   ├── api/             # API 응답 모델/유틸
│   │   ├── di/              # DI 컨테이너 설정 (tsyringe)
│   │   ├── http/            # HTTP 클라이언트 (Axios 래퍼)
│   │   ├── router/          # Vue Router 설정
│   │   ├── layouts/         # 공통 레이아웃 (SidebarLayout 등)
│   │   ├── stores/          # 전역 Pinia 스토어
│   │   ├── theme/           # 테마 관리 (다크 모드)
│   │   ├── composables/     # 전역 Composables
│   │   └── utils/           # 공통 유틸리티 (엑셀/쿼리 등)
│   │
│   ├── features/            # 도메인별 기능 모듈
│   │   ├── dashboard/       # 대시보드
│   │   ├── department/      # 조직도/부서
│   │   ├── employee/        # 직원 관리
│   │   ├── project/         # 프로젝트 관리
│   │   ├── party/           # 협력사
│   │   └── chat/            # AI 채팅
│   │
│   ├── components/          # 공용 컴포넌트
│   │   ├── ui/              # shadcn-vue 기본 UI 컴포넌트
│   │   ├── business/        # 비즈니스 컴포넌트 (테이블, 필터 등)
│   │   └── sidebar/         # 사이드바 관련 컴포넌트
│   │
│   └── lib/                 # 유틸리티 함수
│
├── public/                  # 정적 자산
├── tests/                   # E2E 테스트 (Playwright)
├── docs/                    # 프론트엔드 문서
├── package.json
├── vite.config.ts
└── tsconfig.json
```

---

## 주요 아키텍처 패턴

### 1. 레이어 구조

프론트엔드는 다음과 같은 레이어로 구성됩니다:

1. **Core Layer** (`src/core/`): 인프라스트럭처
   - DI 컨테이너
   - HTTP 통신
   - API 응답 모델/유틸
   - 라우팅
   - 전역 상태 관리
   - 공통 유틸리티
   - 레이아웃

2. **Feature Layer** (`src/features/`): 도메인별 기능
   - 각 기능은 독립적인 모듈로 구성
   - `models/` 또는 `entity/` 중심 구조
   - 필요에 따라 `composables/`, `constants/`, `configs/` 확장

3. **Component Layer** (`src/components/`): 재사용 가능한 UI
   - `ui/`: shadcn-vue 기본 컴포넌트
   - `business/`: 비즈니스 로직이 포함된 컴포넌트

### 2. Feature 모듈 구조

각 feature는 다음과 같은 구조를 기본으로 하되, 필요에 따라 확장합니다:

```
features/employee/
├── models/              # TypeScript 인터페이스, 타입 정의 (또는 entity/)
├── repository/          # API 통신 레이어 (DI로 주입)
├── views/               # 페이지 컴포넌트
├── components/          # Feature 전용 컴포넌트
├── composables/         # Feature 전용 Composable (선택)
├── constants/           # 상수 정의 (선택)
└── configs/             # 테이블/컬럼 등 설정 (선택)
```

예를 들어 `chat` 기능은 `entity/`를 사용해 채팅 메시지 모델을 정의합니다.

**예시: Employee 기능**
- `models/employee.ts`: 직원 상세/생성 타입 정의
- `models/employeeListItem.ts`: 목록용 모델
- `repository/EmployeeRepository.ts`: 직원 API 호출
- `views/EmployeeListView.vue`: 직원 목록 페이지
- `views/EmployeeDetailView.vue`: 직원 상세 페이지
- `configs/tableColumns.ts`: 테이블 컬럼 설정
- `constants/avatars.ts`: 아바타 옵션

---

## 의존성 주입 (DI)

프로젝트는 **tsyringe**를 사용하여 의존성 주입을 구현합니다.

### DI 컨테이너 설정

**파일**: `src/core/di/container.ts`

```typescript
export const appContainer = container;

export function configureContainer() {
  if (!appContainer.isRegistered(AxiosHttpClient)) {
    appContainer.registerSingleton(AxiosHttpClient, AxiosHttpClient);
  }

  if (!appContainer.isRegistered(HttpRepository)) {
    appContainer.registerSingleton(HttpRepository, HttpRepository);
  }
}
```

### Repository 등록

각 Repository는 `@singleton()` 데코레이터로 싱글톤으로 등록됩니다:

```typescript
@singleton()
export class EmployeeRepository {
  constructor(@inject(HttpRepository) private readonly httpRepository: HttpRepository) {}
  
  async findById(id: string): Promise<Employee> {
    return await this.httpRepository.get({ path: `/api/employees/${id}` });
  }
}
```

### 컴포넌트에서 사용

```typescript
import { appContainer } from '@/core/di/container';
import { EmployeeRepository } from '@/features/employee/repository/EmployeeRepository';

const employeeRepository = appContainer.resolve(EmployeeRepository);
```

---

## HTTP 통신

### HTTP Repository

**파일**: `src/core/http/HttpRepository.ts`

모든 API 호출은 `HttpRepository`를 통해 이루어집니다:

```typescript
type HttpRequestConfig = {
  path: string;
  params?: Record<string, unknown>;
  data?: unknown;
};

class HttpRepository {
  get<T = unknown>(config: HttpRequestConfig): Promise<T>
  post<T = unknown>(config: HttpRequestConfig): Promise<T>
  put<T = unknown>(config: HttpRequestConfig): Promise<T>
  patch<T = unknown>(config: HttpRequestConfig): Promise<T>
  delete<T = unknown>(config: HttpRequestConfig): Promise<T>
  download(config: HttpRequestConfig): Promise<Response>
  upload(
    config: HttpRequestConfig & { onProgress?: (progress: number) => void },
  ): Promise<unknown>
}
```

### Axios 클라이언트

**파일**: `src/core/http/AxiosHttpClient.ts`

Axios를 래핑하여 공통 설정을 관리합니다:
- Base URL 설정
- 인터셉터 (요청/응답 처리)
- 에러 핸들링

---

## 라우팅

**파일**: `src/core/router/index.ts`

### 주요 라우트

| 경로 | 이름 | 컴포넌트 | 설명 |
|------|------|----------|------|
| `/` | dashboard | DashboardView | 대시보드 |
| `/departments` | departments | DepartmentView | 부서/조직도 |
| `/departments/:departmentId` | department | DepartmentView | 부서 상세 |
| `/employees` | employees | EmployeeListView | 직원 목록 |
| `/employees/:employeeId` | employee-detail | EmployeeDetailView | 직원 상세 |
| `/projects` | projects | ProjectListView | 프로젝트 목록 |
| `/projects/:projectId` | project-detail | ProjectDetailView | 프로젝트 상세 |
| `/parties` | parties | PartyListView | 협력사 목록 |
| `/parties/:partyId` | party-detail | PartyDetailView | 협력사 상세 |
| `/assistant` | assistant | ChatView | AI 챗봇 |
| `/assistant/:sessionId` | assistant-session | ChatView | AI 챗봇 세션 |

### 라우트 메타데이터

각 라우트는 다음 메타데이터를 가집니다:

```typescript
meta: {
  title: '페이지 제목',
  layout: SidebarLayout,         // 레이아웃 지정
  padding: 'flush',              // 패딩 옵션 (옵션)
  breadcrumbs: [                 // 브레드크럼
    { title: '대시보드', to: '/' },
    { title: '현재 페이지', disabled: true }
  ]
}
```

---

## 상태 관리

### Pinia Store

**파일**: `src/core/stores/notifications.store.ts`

전역 상태는 Pinia를 사용하여 관리합니다:

```typescript
export const useNotificationsStore = defineStore('notifications', () => {
  const notifications = ref<Notification[]>([]);
  
  function addNotification(notification: Notification) {
    notifications.value.push(notification);
  }
  
  return { notifications, addNotification };
});
```

---

## UI 컴포넌트

### shadcn-vue 컴포넌트

**디렉토리**: `src/components/ui/`

프로젝트는 shadcn-vue의 컴포넌트를 사용합니다:

**주요 컴포넌트**:
- `Button`, `Input`, `Select`, `Checkbox`, `Radio`
- `Dialog`, `Sheet`, `Drawer`, `Popover`
- `Table`, `Card`, `Badge`, `Avatar`
- `Form`, `Calendar`, `DatePicker`
- `Command`, `Combobox`, `Tooltip`
- `Alert`, `Skeleton`, `Progress`
- `Sidebar` (v4)

### 비즈니스 컴포넌트

**디렉토리**: `src/components/business/`

**주요 컴포넌트**:
- `DataTable.vue`: TanStack Table 기반 테이블
- `DataTablePagination.vue`: 페이징 컴포넌트
- `DataTableFacetedFilter.vue`: 다중 선택 필터
- `DataTableToolbar.vue`: 테이블 도구 모음
- `CommandPalette.vue`: 명령 팔레트 (Cmd+K)
- `NotificationsSheet.vue`: 알림 사이드바
- `ExcelUploadDialog.vue`: Excel 업로드 다이얼로그

---

## 데이터 모델

### 페이징 응답

**파일**: `src/core/api/page.ts`

```typescript
interface PageResponsePayload<T> {
  page: number;
  size: number;
  totalPages: number;
  totalElements: number;
  content: T[];
}
```

### Enum 응답

**파일**: `src/core/api/enum.ts`

```typescript
interface EnumResponse {
  code: string;
  description: string;
}
```

### 직원 모델

**파일**: `src/features/employee/models/employee.ts`

```typescript
interface EmployeeSummary {
  departmentId: number;
  departmentName: string;
  employeeId: number;
  name: string;
  email: string;
  position: string;
  positionCode: string;
  status: string;
  statusCode: string;
  grade: string;
  gradeCode: string;
  type: string;
  typeCode: string;
  avatarCode: string;
  avatarLabel: string;
  avatarImageUrl: string;
  memo: string;
  joinDate: string;
  birthDate: string;
}

interface EmployeeCreatePayload {
  name: string;
  email: string;
  departmentId: number;
  joinDate: string;
  birthDate: string;
  position: string;
  type: string;
  grade: string;
  avatar: string;
  memo?: string;
}
```

### 프로젝트 모델

**파일**: `src/features/project/models/projectDetail.ts`

```typescript
interface ProjectDetail {
  projectId: number;
  partyId: number;
  partyName: string;
  code: string;
  name: string;
  description: string | null;
  status: string;
  statusLabel: string;
  contractAmount: number;
  startDate: string;
  endDate: string | null;
}
```

### 조직도 모델

**파일**: `src/features/department/models/department.ts`

```typescript
interface DepartmentChartNode {
  departmentId: number;
  departmentName: string;
  departmentCode: string;
  departmentType: string;
  departmentLeader: DepartmentLeader | null;
  employeeCount: number;
  children: DepartmentChartNode[];
}

interface DepartmentLeader {
  employeeId: number;
  employeeName: string;
  position: string;
  avatarCode: string;
  avatarLabel: string;
  avatarImageUrl: string;
}
```

---

## 테마 관리

### 다크 모드

**파일**: `src/core/composables/useTheme.ts`

```typescript
const { theme, resolvedTheme, toggleTheme } = useTheme();

theme.value = 'dark' | 'light' | 'system';
toggleTheme();
resolvedTheme.value  // 실제 적용된 테마
```

### CSS 변수

**파일**: `src/index.css`

Tailwind와 OKLCH 기반의 컬러 토큰을 사용합니다:

```css
:root {
  --background: oklch(100% 0 0);
  --foreground: oklch(9% 0 0);
  --primary: oklch(47% 0.29 256);
  /* ... */
}

.dark {
  --background: oklch(9% 0 0);
  --foreground: oklch(98% 0 0);
  /* ... */
}
```

---

## 폼 검증

프로젝트는 **vee-validate**와 **zod**를 사용하여 폼 검증을 수행합니다.

### 예시

```typescript
import { useForm } from 'vee-validate';
import { toTypedSchema } from '@vee-validate/zod';
import * as z from 'zod';

const schema = z.object({
  name: z.string().min(1).max(10),
  email: z.string().email(),
});

const { handleSubmit, values, errors } = useForm({
  validationSchema: toTypedSchema(schema),
});

const onSubmit = handleSubmit((values) => {
  // 제출 로직
});
```

---

## 테이블 (TanStack Table)

### DataTable 컴포넌트

**파일**: `src/components/business/DataTable.vue`

TanStack Table을 래핑한 재사용 가능한 테이블 컴포넌트입니다.

**주요 기능**:
- 정렬 (다중 컬럼)
- 필터링 (faceted filter)
- 페이징
- 행 선택
- 컬럼 표시/숨김

### 사용 예시

```vue
<DataTable
  :columns="columns"
  :data="employees"
  :pagination="pagination"
  @sort-change="handleSortChange"
/>
```

---

## 레이아웃

### SidebarLayout

**파일**: `src/core/layouts/SidebarLayout.vue`

앱의 메인 레이아웃으로, 다음 요소를 포함합니다:

- **AppSidebar**: 좌측 네비게이션 사이드바
- **헤더**: 브레드크럼, 검색, 알림, 테마 토글, 프로필
- **메인 컨텐츠**: 라우터 뷰
- **CommandPalette**: 명령 팔레트 (Cmd+K)
- **NotificationsSheet**: 알림 시트

---

## 스크립트 명령어

### 개발

```bash
npm run dev          # 개발 서버 시작 (Vite)
npm run build        # 프로덕션 빌드
npm run preview      # 빌드 결과 미리보기
```

### 코드 품질

```bash
npm run typecheck    # TypeScript 타입 체크
npm run lint         # ESLint 린트 검사
npm run lint:fix     # ESLint 자동 수정
npm run format       # Prettier 포맷 체크
npm run format:write # Prettier 자동 포맷팅
```

### 테스트

```bash
npm run test         # Vitest 단위 테스트
npx playwright test  # Playwright E2E 테스트
```

---

## 주요 라이브러리

| 라이브러리 | 용도 |
|------------|------|
| `vue` | 프레임워크 |
| `vue-router` | 라우팅 |
| `pinia` | 상태 관리 |
| `axios` | HTTP 클라이언트 |
| `tsyringe` | DI 컨테이너 |
| `tailwindcss` | CSS 프레임워크 |
| `reka-ui` | Headless UI (shadcn-vue 기반) |
| `@tanstack/vue-table` | 테이블 |
| `vee-validate` | 폼 검증 |
| `zod` | 스키마 검증 |
| `lucide-vue-next` | 아이콘 |
| `vue-sonner` | 토스트 알림 |
| `gojs` | 조직도 시각화 |
| `marked` | 마크다운 렌더링 |
| `shiki` | 코드 하이라이팅 |

---

## 개발 가이드

### 1. 새 기능 추가하기

1. `src/features/<feature-name>/` 디렉토리 생성
2. 다음 하위 디렉토리 추가:
   - `models/` 또는 `entity/`: 타입 정의
   - `repository/`: API 레포지토리
   - `views/`: 페이지 컴포넌트
   - `components/`: Feature 전용 컴포넌트
   - 필요 시 `composables/`, `constants/`, `configs/` 추가
3. Repository를 DI 컨테이너에 등록 (`@singleton()`)
4. 라우트 추가 (`src/core/router/index.ts`)

### 2. API 호출 패턴

```typescript
@singleton()
export class MyRepository {
  constructor(@inject(HttpRepository) private http: HttpRepository) {}
  
  async getList(params: SearchParams): Promise<PageResponse<Item>> {
    return await this.http.get({
      path: '/api/items',
      params: buildQueryParams(params),
    });
  }
  
  async create(data: CreateData): Promise<Item> {
    return await this.http.post({
      path: '/api/items',
      data,
    });
  }
}
```

### 3. 컴포넌트 작성 패턴

```vue
<script setup lang="ts">
import { ref, onMounted } from 'vue';
import { appContainer } from '@/core/di/container';
import { MyRepository } from '@/features/my-feature/repository/MyRepository';

const repository = appContainer.resolve(MyRepository);
const items = ref<Item[]>([]);

onMounted(async () => {
  items.value = await repository.getList();
});
</script>

<template>
  <div>
    <div v-for="item in items" :key="item.id">
      {{ item.name }}
    </div>
  </div>
</template>
```

### 4. shadcn-vue 컴포넌트 추가

```bash
npx shadcn-vue@latest add <component-name>
```

컴포넌트는 `src/components/ui/`에 자동으로 생성됩니다.

---

## 브라우저 지원

- Chrome (최신 2개 버전)
- Firefox (최신 2개 버전)
- Safari (최신 2개 버전)
- Edge (최신 2개 버전)

---

## 성능 최적화

- **Code Splitting**: 라우트별 lazy loading
- **Tree Shaking**: Vite 자동 최적화
- **CSS Purging**: Tailwind 자동 최적화
- **Asset Optimization**: Vite 자동 최적화

---

**문서 버전**: 1.1  
**최종 업데이트**: 2026-01-27
