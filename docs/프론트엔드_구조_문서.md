# ABMS 프론트엔드 구조 문서

## 개요

ABMS 프론트엔드는 **Vue 3 + TypeScript + Vite**로 구성된 단일 페이지 애플리케이션(SPA)입니다.

**주요 기술 스택**:
- **프레임워크**: Vue 3.5.21+
- **빌드 도구**: Vite 7.1.6
- **언어**: TypeScript 5.8.3 (strict mode)
- **상태 관리**: Pinia 3.0.3
- **라우팅**: Vue Router 4.5.1
- **스타일링**: Tailwind CSS 4.1.13
- **UI 컴포넌트**: shadcn-vue (Reka UI 기반)
- **아이콘**: Lucide Vue Next
- **테이블**: TanStack Table 8
- **폼 검증**: vee-validate + zod
- **HTTP 클라이언트**: Axios
- **DI 컨테이너**: tsyringe
- **마크다운**: Marked + Shiki
- **조직도**: GoJS
- **유틸리티**: @vueuse/core, es-hangul

---

## 프로젝트 구조

```
frontend/
├── src/
│   ├── main.ts              # 앱 진입점 (DI, 테마, Vue 앱 초기화)
│   ├── App.vue              # 루트 컴포넌트 (SidebarProvider 포함)
│   ├── index.css            # 전역 CSS (Tailwind, 테마 변수, 폰트)
│   │
│   ├── core/                # 인프라 레이어
│   │   ├── api/             # API 응답 모델/유틸 (enum.ts, page.ts)
│   │   ├── di/              # DI 컨테이너 설정 (tsyringe)
│   │   ├── http/            # HTTP 클라이언트 (Axios 래퍼)
│   │   ├── router/          # Vue Router 설정
│   │   ├── layouts/         # 공통 레이아웃 (SidebarLayout)
│   │   ├── stores/          # 전역 Pinia 스토어
│   │   ├── theme/           # 테마 관리 (다크 모드)
│   │   ├── composables/     # 전역 Composables (useTheme, useQuerySync 등)
│   │   └── utils/           # 공통 유틸리티 (excel.ts 등)
│   │
│   ├── features/            # 도메인별 기능 모듈
│   │   ├── dashboard/       # 대시보드
│   │   ├── department/      # 조직도/부서
│   │   ├── employee/        # 직원 관리
│   │   ├── project/         # 프로젝트 관리
│   │   ├── party/           # 협력사
│   │   └── chat/            # AI 채팅
│   │
│   ├── components/          # 공용 컴포넌트
│   │   ├── ui/              # shadcn-vue 기본 UI 컴포넌트
│   │   ├── business/        # 비즈니스 공통 컴포넌트 (테이블, 필터, 다이얼로그)
│   │   └── sidebar/         # 사이드바 관련 컴포넌트
│   │
│   └── lib/                 # shadcn-vue 유틸리티 (utils.ts)
│
├── public/                  # 정적 자산
├── tests/                   # E2E 테스트 (Playwright)
├── docs/                    # 프론트엔드 문서
├── package.json
├── vite.config.ts
└── tsconfig.json
```

---

## 주요 아키텍처 패턴

### 1. 레이어 구조

프론트엔드는 다음과 같은 레이어로 구성됩니다:

1. **Core Layer** (`src/core/`): 인프라스트럭처
   - DI 컨테이너 (`di/`)
   - HTTP 통신 (`http/`)
   - API 응답 모델/유틸 (`api/`)
   - 라우팅 (`router/`)
   - 전역 상태 관리 (`stores/`)
   - 공통 유틸리티 및 Composables

2. **Feature Layer** (`src/features/`): 도메인별 기능
   - 각 기능은 독립적인 모듈로 구성
   - `models/` 또는 `entity/`, `repository/`, `views/`, `components/` 구조

3. **Component Layer** (`src/components/`): 재사용 가능한 UI
   - `ui/`: shadcn-vue 기본 컴포넌트
   - `business/`: 비즈니스 로직이 포함된 공통 컴포넌트

### 2. Feature 모듈 구조

각 feature는 다음과 같은 구조를 따릅니다:

```
features/employee/
├── models/              # TypeScript 인터페이스, 타입 정의 (employee.ts, employeeListItem.ts 등)
├── repository/          # API 통신 레이어 (Repository 클래스)
├── views/               # 페이지 컴포넌트 (EmployeeListView.vue, EmployeeDetailView.vue)
├── components/          # Feature 전용 컴포넌트 (Dialog, Panel, Card 등)
├── composables/         # Feature 전용 Composable (useEmployeeQuerySync.ts 등)
├── constants/           # 상수 정의 (avatars.ts 등)
└── configs/             # 테이블 컬럼 설정 등
```

**예시: Chat 기능**
- `entity/ChatMessage.ts`: 채팅 메시지 모델
- `repository/RemoteChatRepository.ts`: 채팅 API 구현체
- `components/`: ChatWidget, ChatComposer 등
- `views/ChatView.vue`: 채팅 메인 뷰

---

## 의존성 주입 (DI)

프로젝트는 **tsyringe**를 사용하여 의존성 주입을 구현합니다.

### DI 컨테이너 설정

**파일**: `src/core/di/container.ts`

```typescript
export const appContainer = container;

export function configureContainer() {
  if (!appContainer.isRegistered(AxiosHttpClient)) {
    appContainer.registerSingleton(AxiosHttpClient, AxiosHttpClient);
  }

  if (!appContainer.isRegistered(HttpRepository)) {
    appContainer.registerSingleton(HttpRepository, HttpRepository);
  }
}
```

### Repository 등록

각 Repository는 `@singleton()` 데코레이터로 싱글톤으로 등록됩니다.

**예시**:
```typescript
@singleton()
export class EmployeeRepository {
  constructor(@inject(HttpRepository) private readonly httpRepository: HttpRepository) {}
  
  async findById(id: number): Promise<EmployeeSummary> {
    // ...
  }
}
```

---

## HTTP 통신

### HTTP Repository

**파일**: `src/core/http/HttpRepository.ts`

모든 API 호출은 `HttpRepository`를 통해 이루어집니다. `AxiosHttpClient`를 주입받아 사용하며, `get`, `post`, `put`, `patch`, `delete`, `download`, `upload` 메서드를 제공합니다.

### Axios 클라이언트

**파일**: `src/core/http/AxiosHttpClient.ts`

- Base URL 및 Timeout 설정 (`import.meta.env` 사용)
- Response Interceptor를 통한 에러 핸들링 (`HttpError`)
- `withCredentials: true` 설정

---

## 상태 관리

### Pinia Store

**파일**: `src/core/stores/notifications.store.ts`

전역 상태는 Pinia를 사용하여 관리하며, Options API 스타일(`defineStore`의 객체 인자)을 사용합니다.

```typescript
export const useNotificationsStore = defineStore('notifications', {
  state: () => ({
    items: [] as NotificationItem[],
  }),
  getters: {
    unreadCount: (state) => state.items.filter((item) => !item.read).length,
    // ...
  },
  actions: {
    markAsRead(id: string) { /* ... */ },
    add(notification: ...) { /* ... */ },
    // ...
  },
});
```

---

## 데이터 모델

### Enum 응답

**파일**: `src/core/api/enum.ts`

백엔드의 `EnumResponse` 구조를 따르며, `level` 필드가 포함되어 있습니다.

```typescript
export interface EnumResponse {
  code: string;
  description: string;
  level: number;
}
```

### 직원 모델 (EmployeeSummary)

**파일**: `src/features/employee/models/employee.ts`

```typescript
export interface EmployeeSummary {
  departmentId: number;
  departmentName: string;
  employeeId: number;
  name: string;
  email: string;
  position: string;
  positionCode: string;
  status: string;
  statusCode: string;
  grade: string;
  gradeCode: string;
  type: string;
  typeCode: string;
  avatarCode: string;
  avatarLabel: string;
  avatarImageUrl: string;
  memo: string;
  joinDate: string;
  birthDate: string;
}
```

### 프로젝트 모델 (ProjectDetail)

**파일**: `src/features/project/models/projectDetail.ts`

```typescript
export interface ProjectDetail {
  projectId: number;
  partyId: number;
  partyName: string;
  code: string;
  name: string;
  description: string | null;
  status: string;
  statusLabel: string;
  contractAmount: number;
  startDate: string;
  endDate: string | null;
  leadDepartmentId: number | null; // 주관 부서 ID
  leadDepartmentName: string | null; // 주관 부서명
}
```

---

## UI 컴포넌트

### 비즈니스 공통 컴포넌트

**디렉토리**: `src/components/business/`

- `DataTable.vue`: TanStack Table 기반 테이블
- `DataTablePagination.vue`: 페이징
- `DataTableFacetedFilter.vue`: 다중 선택 필터
- `DataTableToolbar.vue`: 툴바
- `DataTableColumnHeader.vue`: 정렬 가능한 컬럼 헤더
- `DateRangeFilter.vue`: 날짜 범위 필터
- `CommandPalette.vue`: 명령 팔레트 (`Cmd+K`)
- `NotificationsSheet.vue`: 알림 사이드바
- `ProfileDialog.vue`: 사용자 프로필 모달
- `ExcelUploadDialog.vue`: 엑셀 업로드

### Feature별 주요 컴포넌트

- **Employee**: `EmployeeCreateDialog`, `EmployeeUpdateDialog`, `EmployeePromotionDialog`, `EmployeePositionTimeline` 등 다양한 패널과 다이얼로그 포함.
- **Department**: `DepartmentTree`, `DepartmentOrganizationChart`(GoJS), `DepartmentLeaderAssignDialog` 등.
- **Project**: `ProjectSummaryCards`, `ProjectRevenuePlanPanel` 등.
- **Chat**: `ChatWidget`, `ChatComposer`, `ChatMessage`, `MarkdownRenderer` 등.

---

## 개발 가이드 및 스크립트

### 스크립트 명령어

```bash
npm run dev          # 개발 서버 시작 (Vite)
npm run build        # 프로덕션 빌드 (vue-tsc + vite build)
npm run preview      # 빌드 결과 미리보기
npm run typecheck    # TypeScript 타입 체크 (vue-tsc --noEmit)
npm run lint         # ESLint 검사
npm run lint:fix     # ESLint 자동 수정
npm run format       # Prettier 포맷 체크
npm run format:write # Prettier 자동 포맷팅
npm run test         # Vitest 단위 테스트
```

### 새 기능 추가 시 체크리스트

1. `features/<feature>` 디렉토리 구조 생성
2. `models` 정의 (백엔드 API 응답과 일치)
3. `repository` 구현 및 DI 컨테이너 등록 (`@singleton`)
4. `views` 및 `components` 구현
5. `router`에 라우트 추가
6. 필요한 경우 `stores`나 `composables` 추가

---

**최종 업데이트**: 2026-02-10
